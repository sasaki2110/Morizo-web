# Morizo-aiv2 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä»•æ§˜æ›¸

## æ¦‚è¦
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆMorizo-webï¼‰ãŒæœŸå¾…ã™ã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ã®ä»•æ§˜æ›¸ã§ã™ã€‚
Morizo-aiv2ã¯ä»¥ä¸‹ã®å½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

## 1. é€šå¸¸ã®ãƒãƒ£ãƒƒãƒˆAPIãƒ¬ã‚¹ãƒãƒ³ã‚¹ (`/chat`)

### æˆåŠŸæ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
```json
{
  "response": "å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
  "success": true
}
```

### ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
```json
{
  "error": "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
  "success": false
}
```

## 2. ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ (`/chat/stream/{sseSessionId}`)

### SSEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å½¢å¼
ã™ã¹ã¦ã®SSEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®åŸºæœ¬æ§‹é€ ã‚’æŒã¡ã¾ã™ï¼š

```json
{
  "type": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—",
  "sse_session_id": "ã‚»ãƒƒã‚·ãƒ§ãƒ³ID",
  "timestamp": "2025-01-27T12:00:00.000Z",
  "message": "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹",
  "progress": {
    "completed_tasks": 0,
    "total_tasks": 0,
    "progress_percentage": 0,
    "current_task": "",
    "remaining_tasks": 0,
    "is_complete": false
  }
}
```

### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—åˆ¥ã®è©³ç´°ä»•æ§˜

#### 2.1 `start` - å‡¦ç†é–‹å§‹
```json
{
  "type": "start",
  "sse_session_id": "66f958f4-170f-48be-99c9-7a7f66dc48c6",
  "timestamp": "2025-01-27T12:00:00.000Z",
  "message": "å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™",
  "progress": {
    "completed_tasks": 0,
    "total_tasks": 4,
    "progress_percentage": 0,
    "current_task": "ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡",
    "remaining_tasks": 4,
    "is_complete": false
  }
}
```

#### 2.2 `progress` - é€²æ—æ›´æ–°
```json
{
  "type": "progress",
  "sse_session_id": "66f958f4-170f-48be-99c9-7a7f66dc48c6",
  "timestamp": "2025-01-27T12:00:01.000Z",
  "message": "ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ä¸­...",
  "progress": {
    "completed_tasks": 1,
    "total_tasks": 4,
    "progress_percentage": 25,
    "current_task": "AIå‡¦ç†ä¸­",
    "remaining_tasks": 3,
    "is_complete": false
  }
}
```

#### 2.3 `complete` - å‡¦ç†å®Œäº† â­ **æœ€é‡è¦**
```json
{
  "type": "complete",
  "sse_session_id": "66f958f4-170f-48be-99c9-7a7f66dc48c6",
  "timestamp": "2025-01-27T12:00:05.000Z",
  "message": "å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ",
  "progress": {
    "completed_tasks": 4,
    "total_tasks": 4,
    "progress_percentage": 100,
    "current_task": "å®Œäº†",
    "remaining_tasks": 0,
    "is_complete": true
  },
  "result": {
    "response": "å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
  }
}
```

**é‡è¦**: `result.response`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
ã“ã‚ŒãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§è¡¨ç¤ºã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãªã‚Šã¾ã™ã€‚

#### 2.4 `error` - ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ
```json
{
  "type": "error",
  "sse_session_id": "66f958f4-170f-48be-99c9-7a7f66dc48c6",
  "timestamp": "2025-01-27T12:00:03.000Z",
  "message": "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
  "progress": {
    "completed_tasks": 2,
    "total_tasks": 4,
    "progress_percentage": 50,
    "current_task": "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ",
    "remaining_tasks": 2,
    "is_complete": false
  },
  "error": {
    "code": "PROCESSING_ERROR",
    "message": "è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
    "details": "ã‚¨ãƒ©ãƒ¼ã®è©³ç´°æƒ…å ±ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰"
  }
}
```

#### 2.5 `timeout` - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
```json
{
  "type": "timeout",
  "sse_session_id": "66f958f4-170f-48be-99c9-7a7f66dc48c6",
  "timestamp": "2025-01-27T12:03:00.000Z",
  "message": "å‡¦ç†ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ",
  "progress": {
    "completed_tasks": 2,
    "total_tasks": 4,
    "progress_percentage": 50,
    "current_task": "ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ",
    "remaining_tasks": 2,
    "is_complete": false
  }
}
```

## 3. ç¾åœ¨ã®å•é¡Œã¨è§£æ±ºæ–¹æ³•

### å•é¡Œã®è©³ç´°
ç¾åœ¨ã€Morizo-aiv2ã‹ã‚‰ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œã¦ã„ã¾ã™ï¼š
```
"ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸãŒã€çµæœã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"
```

ã—ã‹ã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯`result.response`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å€¤ã€Œå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

### è§£æ±ºæ–¹æ³•
`complete`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®`result.response`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

```json
{
  "type": "complete",
  "message": "å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ",
  "result": {
    "response": "ã“ã‚“ã«ã¡ã¯ï¼ä½•ã‹ãŠæ‰‹ä¼ã„ã§ãã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ"
  }
}
```

## 4. ãƒ¬ã‚·ãƒ”è¡¨ç¤ºæ©Ÿèƒ½ã®å¯¾å¿œ

### ãƒ¬ã‚·ãƒ”ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å½¢å¼
ãƒ¬ã‚·ãƒ”è¡¨ç¤ºæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®å½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¦ãã ã•ã„ï¼š

```
ğŸ“ æ–¬æ–°ãªææ¡ˆ

ğŸ– **ã‚µãƒ¼ãƒ¢ãƒ³ã®ãƒ ãƒ¼ã‚¹é¢¨ãƒ‘ãƒ†**: [ã‚µãƒ¼ãƒ¢ãƒ³ãƒ ãƒ¼ã‚¹ã®ä½œã‚Šæ–¹](https://cookpad.com/recipe/1234567) [ãƒ•ãƒ¬ãƒ³ãƒé¢¨ã‚µãƒ¼ãƒ¢ãƒ³ãƒ‘ãƒ†](https://delishkitchen.tv/recipes/2345678)

ğŸ¥— **ã‚¢ãƒœã‚«ãƒ‰ã¨ãƒˆãƒãƒˆã®ã‚µãƒ©ãƒ€**: [ã‚¢ãƒœã‚«ãƒ‰ã‚µãƒ©ãƒ€ã®åŸºæœ¬](https://cookpad.com/recipe/3456789) [ãƒˆãƒãƒˆã¨ã‚¢ãƒœã‚«ãƒ‰ã®çµ„ã¿åˆã‚ã›](https://delishkitchen.tv/recipes/4567890)

ğŸµ **ã‚³ãƒ³ã‚½ãƒ¡ã‚¹ãƒ¼ãƒ—**: [ã‚³ãƒ³ã‚½ãƒ¡ã‚¹ãƒ¼ãƒ—ã®ä½œã‚Šæ–¹](https://cookpad.com/recipe/5678901) [ãƒ•ãƒ¬ãƒ³ãƒã‚³ãƒ³ã‚½ãƒ¡](https://delishkitchen.tv/recipes/6789012)

ğŸ“š ä¼çµ±çš„ãªææ¡ˆ

ğŸ– **ç”Ÿå§œç„¼ã**: [ç”Ÿå§œç„¼ãã®åŸºæœ¬ãƒ¬ã‚·ãƒ”](https://cookpad.com/recipe/7890123) [æœ¬æ ¼ç”Ÿå§œç„¼ã](https://delishkitchen.tv/recipes/8901234)

ğŸ¥— **ã»ã†ã‚Œã‚“è‰ã®ãŠæµ¸ã—**: [ãŠæµ¸ã—ã®ä½œã‚Šæ–¹](https://cookpad.com/recipe/9012345) [æœ¬æ ¼ãŠæµ¸ã—](https://delishkitchen.tv/recipes/0123456)

ğŸµ **å‘³å™Œæ±**: [å‘³å™Œæ±ã®åŸºæœ¬](https://cookpad.com/recipe/1234567) [æœ¬æ ¼å‘³å™Œæ±](https://delishkitchen.tv/recipes/2345678)
```

## 5. å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å¿…é ˆå®Ÿè£…é …ç›®
- [ ] `complete`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«`result.response`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
- [ ] å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’`result.response`ã«è¨­å®š
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‡¦ç†ã®å®Ÿè£…

### æ¨å¥¨å®Ÿè£…é …ç›®
- [ ] `connected`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—ã®å¯¾å¿œï¼ˆç¾åœ¨ã¯è­¦å‘Šãƒ¬ãƒ™ãƒ«ï¼‰
- [ ] ã‚ˆã‚Šè©³ç´°ãªé€²æ—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- [ ] ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®æ¨™æº–åŒ–

## 6. ãƒ†ã‚¹ãƒˆæ–¹æ³•

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®ç¢ºèªæ–¹æ³•
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
2. ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¿ãƒ–ã§ãƒ­ã‚°ã‚’ç¢ºèª
3. ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼š
   ```
   ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡: { type: "complete", result: { response: "å®Ÿéš›ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸" } }
   ```

### æœŸå¾…ã•ã‚Œã‚‹çµæœ
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã€Œå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€ã§ã¯ãªãã€å®Ÿéš›ã®AIãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- ãƒ¬ã‚·ãƒ”è¡¨ç¤ºæ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

## 7. é€£çµ¡å…ˆ

ã“ã®ä»•æ§˜æ›¸ã«ã¤ã„ã¦è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºãƒãƒ¼ãƒ ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

---
**ä½œæˆæ—¥**: 2025å¹´1æœˆ27æ—¥  
**å¯¾è±¡**: Morizo-aiv2é–‹ç™ºãƒãƒ¼ãƒ   
**ä½œæˆè€…**: Morizo-webé–‹ç™ºãƒãƒ¼ãƒ 
